/* src/styles/globals.css */
@import '../branding/brand.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ========== BASE (tokens, accesibilidad, tipograf√≠a, pulido) ========== */
@layer base {
  :root {
    /* Safe areas iOS */
    --safe-top: env(safe-area-inset-top);
    --safe-right: env(safe-area-inset-right);
    --safe-bottom: env(safe-area-inset-bottom);
    --safe-left: env(safe-area-inset-left);
  }

  html {
    color-scheme: light dark;
    -webkit-text-size-adjust: 100%;
    text-rendering: optimizeLegibility;
    scroll-behavior: smooth;
  }

  html,
  body {
    @apply font-body antialiased;
    min-height: 100dvh;
    background: var(--color-bg);
    color: var(--color-text);

    ::placeholder {
      color: var(--color-text-muted);
    }
  }

  :where(input, select, textarea, button) {
    accent-color: theme('colors.brand.blue');
    caret-color: theme('colors.brand.blue');
  }

  h1,
  h2,
  h3,
  h4 {
    @apply font-heading tracking-tight text-brand-blue;
    text-wrap: balance;
    scroll-margin-top: calc(var(--header-h) + 12px);
  }

  a {
    @apply text-brand-blue underline-offset-4 transition-colors hover:underline
      focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-blue/40 focus-visible:ring-offset-2;
  }

  strong,
  .text-accent {
    @apply text-brand-red;
  }

  ::selection {
    background: theme('colors.brand.yellow');
    color: theme('colors.brand.dark');
  }
  ::-moz-selection {
    background: theme('colors.brand.yellow');
    color: theme('colors.brand.dark');
  }

  * {
    scrollbar-width: thin;
    scrollbar-color: var(--color-border) transparent;
  }
  *::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }
  *::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 9999px;
  }
  *::-webkit-scrollbar-thumb:hover {
    background: color-mix(in oklab, var(--color-border), #000 20%);
  }
  *::-webkit-scrollbar-track {
    background: transparent;
  }

  input[type='text'],
  input[type='email'],
  input[type='tel'],
  input[type='number'],
  input[type='date'],
  input[type='search'],
  select,
  textarea {
    @apply rounded-xl border border-brand-dark/15 px-3 py-2 outline-none transition focus:ring-2 focus:ring-brand-blue/30;
    background: var(--color-surface);
    color: var(--color-text);

    ::placeholder {
      color: var(--color-text-muted);
    }
    font-variant-numeric: tabular-nums;
  }

  :where(input, select, textarea):disabled {
    @apply opacity-60 cursor-not-allowed;
  }
  :where(input, select, textarea)[aria-invalid='true'] {
    @apply border-brand-red/50 ring-2 ring-brand-red/20;
  }

  input[type='number']::-webkit-outer-spin-button,
  input[type='number']::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  input[type='number'] {
    appearance: textfield;
    -moz-appearance: textfield;
  }
  input[type='date'],
  input[type='search'] {
    appearance: none;
    -webkit-appearance: none;
    background-clip: padding-box;
  }
  button,
  input,
  select,
  textarea {
    font: inherit;
  }

  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.001ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.001ms !important;
      scroll-behavior: auto !important;
    }
  }
}

/* ========== COMPONENTES (patrones reutilizables) ========== */
@layer components {
  .container { max-width: var(--container-max); }

  .card {
    @apply rounded-2xl shadow-soft border;
    border-color: var(--color-border);
    background: var(--color-surface);
  }

  .btn {
    @apply inline-flex items-center justify-center rounded-[var(--radius)] px-6 py-3 font-heading transition shadow-soft
      focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-blue/40 focus-visible:ring-offset-2;
  }
  .btn-primary {
    @apply bg-brand-yellow text-brand-dark hover:scale-[1.02];
  }
  .btn-accent {
    @apply bg-brand-red text-white hover:scale-[1.02];
  }

  .badge {
    @apply inline-flex items-center rounded-full px-2 py-1 text-xs;
  }
  .badge-muted {
    @apply badge;
    background: var(--color-surface-2);
    color: color-mix(in oklab, var(--color-text), transparent 20%);
  }

  .glass {
    backdrop-filter: blur(var(--backdrop-blur));
    background: color-mix(in oklab, var(--color-bg), transparent 30%);
    border: 1px solid var(--color-border);
  }

  .skeleton {
    position: relative;
    overflow: hidden;
    background: color-mix(in oklab, var(--color-text), transparent 94%);
  }
  .skeleton::after {
    content: '';
    position: absolute;
    inset: 0;
    transform: translateX(-100%);
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(255, 255, 255, 0.55) 50%,
      transparent 100%
    );
    animation: kce-shimmer 1.2s infinite;
  }
}

/* ========== UTILIDADES (keyframes y helpers) ========== */
@keyframes kce-shimmer {
  100% { transform: translateX(100%); }
}

/* ========== PRINT (sobrio, legible) ========== */
@media print {
  :root { --shadow-soft: none; }
  html, body { @apply bg-white text-black; }
  .card {
    box-shadow: none !important;
    border-color: #e5e7eb !important;
    background: #fff !important;
  }
  a { text-decoration: none !important; color: inherit !important; }
}
